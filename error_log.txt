Traceback (most recent call last):
  File "C:\Users\fedez\Desktop\orientati\backend\fastapi-gateway\debug_openapi.py", line 12, in <module>
    res = client.get('/openapi.json')
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\testclient.py", line 479, in get
    return super().get(
           ~~~~~~~~~~~^
        url,
        ^^^^
    ...<6 lines>...
        extensions=extensions,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\httpx\_client.py", line 1053, in get
    return self.request(
           ~~~~~~~~~~~~^
        "GET",
        ^^^^^^
    ...<7 lines>...
        extensions=extensions,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\testclient.py", line 451, in request
    return super().request(
           ~~~~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<11 lines>...
        extensions=extensions,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\utils.py", line 1864, in runner
    return sentry_patched_function(*args, **kwargs)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\httpx.py", line 91, in send
    rv = real_send(self, request, **kwargs)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\testclient.py", line 354, in handle_request
    raise exc
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\testclient.py", line 351, in handle_request
    portal.call(self.app, scope, receive, send)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\anyio\from_thread.py", line 291, in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\fedez\AppData\Local\Programs\Python\Python313\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\fedez\AppData\Local\Programs\Python\Python313\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\anyio\from_thread.py", line 222, in _call_func
    retval = await retval_or_awaitable
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\starlette.py", line 406, in _sentry_patched_asgi_app
    return await middleware(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\asgi.py", line 179, in _run_asgi3
    return await self._run_app(scope, receive, send, asgi_version=3)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\asgi.py", line 269, in _run_app
    raise exc from None
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\asgi.py", line 264, in _run_app
    return await self.app(
           ^^^^^^^^^^^^^^^
        scope, receive, _sentry_wrapped_send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\starlette.py", line 197, in _create_span_call
    return await old_call(app, scope, new_receive, new_send, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\starlette.py", line 197, in _create_span_call
    return await old_call(app, scope, new_receive, new_send, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\gzip.py", line 130, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\starlette.py", line 197, in _create_span_call
    return await old_call(app, scope, new_receive, new_send, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\starlette.py", line 197, in _create_span_call
    return await old_call(app, scope, new_receive, new_send, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\fedez\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\_utils.py", line 83, in collapse_excgroups
    raise exc
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\Desktop\orientati\backend\fastapi-gateway\app\main.py", line 123, in add_security_headers
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\starlette.py", line 197, in _create_span_call
    return await old_call(app, scope, new_receive, new_send, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\fedez\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\_utils.py", line 83, in collapse_excgroups
    raise exc
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\slowapi\middleware.py", line 136, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\starlette.py", line 295, in _sentry_exceptionmiddleware_call
    await old_call(self, scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\starlette.py", line 197, in _create_span_call
    return await old_call(app, scope, new_receive, new_send, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\routing.py", line 78, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\starlette\routing.py", line 75, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\sentry_sdk\integrations\starlette.py", line 477, in _sentry_async_func
    return await old_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\fastapi\applications.py", line 1009, in openapi
    return JSONResponse(self.openapi())
                        ~~~~~~~~~~~~^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\fastapi\applications.py", line 981, in openapi
    self.openapi_schema = get_openapi(
                          ~~~~~~~~~~~^
        title=self.title,
        ^^^^^^^^^^^^^^^^^
    ...<11 lines>...
        separate_input_output_schemas=self.separate_input_output_schemas,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\fastapi\openapi\utils.py", line 514, in get_openapi
    field_mapping, definitions = get_definitions(
                                 ~~~~~~~~~~~~~~~^
        fields=all_fields,
        ^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        separate_input_output_schemas=separate_input_output_schemas,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\fastapi\_compat.py", line 232, in get_definitions
    field_mapping, definitions = schema_generator.generate_definitions(
                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        inputs=inputs
        ^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\pydantic\json_schema.py", line 363, in generate_definitions
    self.generate_inner(schema)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\pydantic\json_schema.py", line 443, in generate_inner
    if 'ref' in schema:
       ^^^^^^^^^^^^^^^
  File "<frozen _collections_abc>", line 817, in __contains__
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\pydantic\_internal\_mock_val_ser.py", line 41, in __getitem__
    return self._get_built().__getitem__(key)
           ~~~~~~~~~~~~~~~^^
  File "C:\Users\fedez\AppData\Local\pypoetry\Cache\virtualenvs\fastapi-gateway-zTN3nP3l-py3.13\Lib\site-packages\pydantic\_internal\_mock_val_ser.py", line 58, in _get_built
    raise PydanticUserError(self._error_message, code=self._code)
pydantic.errors.PydanticUserError: `TypeAdapter[typing.Annotated[ForwardRef('MateriaCreate'), Query(PydanticUndefined)]]` is not fully defined; you should define `typing.Annotated[ForwardRef('MateriaCreate'), Query(PydanticUndefined)]` and all referenced types, then call `.rebuild()` on the instance.

For further information visit https://errors.pydantic.dev/2.11/u/class-not-fully-defined
